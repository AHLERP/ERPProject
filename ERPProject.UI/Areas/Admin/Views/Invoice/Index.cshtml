@using ERPProject.UI.Areas.Admin.Models;
@model InvoiceVM
@inject IHttpContextAccessor Accessor
@{
    ViewData["Title"] = "Faturalar";
    ViewData["baslik"] = "Faturalar";
    ViewData["buttonismi"] = "Fatura Ekle";
    Layout = "~/Areas/Admin/Views/Shared/_AdminLayout.cshtml";
}



<div class="modal fade" id="staticBackdrop" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="staticBackdropLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="staticBackdropLabel">Fatura Ekle</h5>
                <button   type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form enctype="multipart/form-data" action="/Admin/FaturaEkle" method="post">
                    <input type="file" name="FileUpload" required/>
                    <button type="submit" class="btn btn-outline-success">
                        Ekle
                    </button>

                </form>

            </div>

        </div>
    </div>
</div>

<div class="accordion accordion-flush" id="accordionFlushExample">
    @if (@Model==null)
    {
    }
    else
    {
    @foreach (var item in Model.Invoices)

    {


        <div class="accordion-item">
            <h2 class="accordion-header" id="flush-heading-@item.Id">
                <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#flush-collapse-@item.Id" aria-expanded="false" aria-controls="flush-collapse-@item.Id">

                    <span><b>@item.CompanyName</b> isimli şirketimize <b>@item.SupplierName</b> firmasından <b>@item.InvoiceDate.ToShortDateString() </b> tarihinde  <b>@item.TotalPrice</b> tutarındaki alış faturası. </span>
@* 
                                    <span style="margin-right:250px;">@item.SupplierName</span>

                                    <span style="margin-right:260px;">@item.CompanyName</span>

                                    <span> @item.TotalPrice</span>
 *@
                    @* Satıcı: <span style="margin-right:150px;">@item.SupplierName</span>   Şirket: <span style="margin-right:150px;">@item.CompanyName</span>  Fiyat: <span style="margin-right:150px;"> @item.TotalPrice</span> *@




                </button>
            </h2>
            <div id="flush-collapse-@item.Id" class="accordion-collapse collapse" aria-labelledby="flush-heading-@item.Id" data-bs-parent="#accordionFlushExample">
                <div class="accordion-body">
                    <div id="example_filter" class="dataTables_filter">
                        <div id="notFoundMessage" class="text-danger" style="display: none;">Sonuç bulunamadı...</div>
                    </div>
                    <table id="example" class="table table-bordered border-dark">
                        <thead>
                            <tr>
                                <th scope="col">Ürün Adı</th>
                                <th scope="col">Miktar</th>
                                <th scope="col">Birim</th>
                                <th scope="col">Fiyat</th>
                            </tr>
                        </thead>
                        <tbody>

                            @foreach (var a in Model.InvoiceDetail)
                            {
                                @if (a.InvoiceId == item.Id)
                                {
                                    <tr>
                                        <td>@a.ProductName</td>
                                        <td>@a.Quantity</td>
                                        <td>@a.QuantityUnit</td>
                                        <td>@a.Price</td>

                                    </tr>
                                }}



                        </tbody>
                    </table>

                </div>
            </div>
        </div>



    }

    }                       
</div>
<script>


    $('#staticFaturaEkle').on('show.bs.modal', function (event) {
        var button = $(event.relatedTarget);
        var id = button.data('id');
        $("#inputRequestId").val(id);
    });
</script>